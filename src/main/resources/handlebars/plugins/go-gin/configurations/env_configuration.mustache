package configurations

import (
    "com.gitlab.dekaulitz/src/utils"
    "gopkg.in/yaml.v2"
    "io/ioutil"
    "log"
    "os"
    "path/filepath"
)

/**
 * TokitaDevEngine version v1.0
 * Generated by engine io.swagger.codegen.v3.generators.modules.plugins.golang.GolangGin
 * Generated on 09/03/2020 23:26:35
 * Developed by sulaimanfahmi@gmail.com
 */

type Configuration struct {
    DatabaseHost string `yaml:"database_host,omitempty"`
    ServerPort   string `yaml:"server_port,omitempty"`
    RedisHost    string `yaml:"redis_host,omitempty"`
    AppName      string `yaml:"app_name,omitempty"`
}

var config Configuration

func init() {
    filename, err := filepath.Abs("./application.yaml")
    if err != nil {
        panic(err)
    }
    log.Printf("load configuration from %s", filename)
    yamlFile, err := ioutil.ReadFile(filename)
    if err != nil {
        panic(err)
    }
    err = yaml.Unmarshal(yamlFile, &config)
    if err != nil {
        panic(err)
    }
    config.DatabaseHost = os.Getenv(utils.GetEnvironment(config.DatabaseHost))
    config.ServerPort = os.Getenv(utils.GetEnvironment(config.ServerPort))
    config.RedisHost = os.Getenv(utils.GetEnvironment(config.RedisHost))
    config.AppName = os.Getenv(utils.GetEnvironment(config.AppName))
}

func GetConfig() *Configuration {
    return &config
}
