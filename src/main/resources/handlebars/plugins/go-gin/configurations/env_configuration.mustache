package configurations

import (
	"{{basePackage}}/src/utils"
	"gopkg.in/yaml.v2"
	"io/ioutil"
	"os"
	"path/filepath"
)

/**
 * TokitaDevEngine version {{generatorVersion}}
 * Generated by engine {{generatorClass}}
 * Generated on {{generateDate}}
 * Developed by sulaimanfahmi@gmail.com
 */

type Configuration struct {
	DatabaseHost string `yaml:"database_host,omitempty"`
	ServerPort   string `yaml:"server_port,omitempty"`
}

var config Configuration

func init() {
	filename, err := filepath.Abs("./application.yaml")
	if err != nil {
		panic(err)
	}
	yamlFile, err := ioutil.ReadFile(filename)
	if err != nil {
		panic(err)
	}
	err = yaml.Unmarshal(yamlFile, &config)
	if err != nil {
		panic(err)
	}
	config.DatabaseHost = os.Getenv(utils.GetEnvironment(config.DatabaseHost))
	config.ServerPort = os.Getenv(utils.GetEnvironment(config.ServerPort))
}

func GetConfig() *Configuration {
	return &config
}
